<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="color-scheme" content="light dark" />
  <title><%= panelConfig?.brandName || "VPN KEY" %></title>

  <link rel="stylesheet" href="/public/00-tokens.css" />
  <link rel="stylesheet" href="/public/01-base.css" />
  <link rel="stylesheet" href="/public/02-layout.css" />
  <link rel="stylesheet" href="/public/03-components.css" />
  <link rel="stylesheet" href="/public/04-pages.css" />
  <link rel="stylesheet" href="/public/05-utilities.css" />
</head>

<body>
<div class="bg-aurora"></div>

<div class="app-shell">

  <!-- HEADER -->
  <header class="app-header glass">
    <div class="container header-inner">
      <div class="brand">
        <div class="brand-icon">‚ö°</div>
        <div>
          <div class="brand-title"><%= panelConfig?.brandName || "VPN KEY" %></div>
          <div class="brand-sub">Fast ‚Ä¢ Simple ‚Ä¢ Secure</div>
        </div>
      </div>

      <% if (panelConfig?.telegramChannelUrl) { %>
        <a class="pill glass-btn small"
           href="<%= panelConfig.telegramChannelUrl %>"
           target="_blank"
           rel="noopener">
           ‚úàÔ∏è Telegram Channel Join ·Äõ·Äî·Ä∫
        </a>
      <% } %>
    </div>
  </header>


  <main class="container main">

    <!-- PANEL NAME -->
    <section class="card glass panel-name">
      <h2><%= panelConfig?.brandName || "VPN KEY PANEL" %></h2>
    </section>


    <!-- TABS -->
    <section class="tabs-wrap">

      <div class="tabs-header">
        <button class="tab-btn active" onclick="switchTab('keys')">Key List</button>
        <button class="tab-btn" onclick="switchTab('guide')">Key ·Äõ·Äö·Ä∞·Äî·Ää·Ä∫·Ä∏</button>
      </div>


      <!-- TAB 1: KEY LIST -->
      <div id="tab-keys" class="tab-content active">

        <!-- FILTER -->
        <section class="card glass filters">
          <details <%= (query.q || query.type || query.status) ? "open" : "" %>>
            <summary class="glass-btn filter-summary">
              üîé Filter
              <span>
                <%= (query.q || query.type || query.status) ? "Active" : "Tap to expand" %>
              </span>
            </summary>

            <form method="GET" action="/" class="filters-grid compact">

              <input type="text"
                     class="input"
                     name="q"
                     placeholder="Search location..."
                     value="<%= query.q || '' %>" />

              <select class="select" name="type">
                <option value="">All Types</option>
                <% (types || []).forEach(t => { %>
                  <option value="<%= t %>" <%= query.type === t ? "selected" : "" %>>
                    <%= t %>
                  </option>
                <% }) %>
              </select>

              <select class="select" name="status">
                <option value="">All Status</option>
                <% (statuses || []).forEach(s => { %>
                  <option value="<%= s %>" <%= query.status === s ? "selected" : "" %>>
                    <%= s %>
                  </option>
                <% }) %>
              </select>

              <div class="filter-actions">
                <button class="btn glass-btn" type="submit">Apply</button>
                <a class="btn glass-btn" href="/">Reset</a>
              </div>
            </form>
          </details>
        </section>


        <!-- KEYS GRID -->
        <section class="keys-grid">

          <% if (!items || items.length === 0) { %>
            <div class="card glass empty">
              No keys found.
            </div>
          <% } %>

          <% (items || []).forEach(item => { %>

            <article class="key-card glass">

              <div class="key-card-top">
                <div class="key-type">
                  <%= (item.type || "").toUpperCase() %>
                </div>

                <div class="status-pill <%= (item.statusComputed || '').toLowerCase() %>">
                  <%= (item.statusComputed || "").toUpperCase() %>
                </div>
              </div>

              <div class="key-region">
                <span class="flag">
                  <%= item.region_flag || "üåç" %>
                </span>
                <span class="region">
                  <%= item.region_name || "Unknown" %>
                </span>
              </div>

              <div class="key-meta">
                <span class="dot">GB <%= item.gb_limit || 0 %></span>
                <span class="dot">Expire <%= item.expire_date || "-" %></span>
              </div>

              <a href="/k/<%= item.id %>" class="key-open glass-btn">
                Tap to open ‚Üí
              </a>

            </article>

          <% }) %>

        </section>
      </div>


      <!-- TAB 2: GUIDE -->
      <div id="tab-guide" class="tab-content">

        <section class="card glass guide-card">
          <h3>VPN Key ·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äî·Ää·Ä∫·Ä∏</h3>
          <ol>
            <li>Key ·ÄÄ·Ä≠·ÄØ Copy ·Äú·ÄØ·Äï·Ä∫·Äï·Ä´</li>
            <li>App ·Äë·Ä≤ Import / Add ‚Üí Paste</li>
            <li>Connect ·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏ ·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äï·Ä´</li>
          </ol>

          <% if (panelConfig?.telegramAdminUrl) { %>
            <a class="pill glass-btn"
               href="<%= panelConfig.telegramAdminUrl %>"
               target="_blank"
               rel="noopener">
               üí¨ Admin ·ÄÜ·ÄÄ·Ä∫·Äû·ÄΩ·Äö·Ä∫·Äõ·Äî·Ä∫
            </a>
          <% } %>
        </section>

      </div>

    </section>


    <footer class="footer">
      ¬© <%= new Date().getFullYear() %>
      <%= panelConfig?.brandName || "FREE KEY" %>
    </footer>

  </main>
</div>


<!-- TAB SCRIPT -->
<script>
function switchTab(name) {
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

  if (name === 'keys') {
    document.querySelectorAll('.tab-btn')[0].classList.add('active');
    document.getElementById('tab-keys').classList.add('active');
  } else {
    document.querySelectorAll('.tab-btn')[1].classList.add('active');
    document.getElementById('tab-guide').classList.add('active');
  }
}
</script>

</body>
</html>
