<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title><%= (panelConfig && panelConfig.brandName) ? panelConfig.brandName : "VPN KEY" %></title>

  <link rel="stylesheet" href="/public/00-tokens.css" />
  <link rel="stylesheet" href="/public/01-base.css" />
  <link rel="stylesheet" href="/public/02-layout.css" />
  <link rel="stylesheet" href="/public/03-components.css" />
  <link rel="stylesheet" href="/public/04-pages.css" />
  <link rel="stylesheet" href="/public/05-utilities.css" />
</head>
<body>
  <div class="bg-aurora" aria-hidden="true"></div>

  <div class="app-shell">
    <header class="app-header">
      <div class="container header-inner">
        <div class="brand">
          <span class="brand-icon" aria-hidden="true">âš¡</span>
          <div class="brand-text">
            <div class="brand-title"><%= panelConfig.brandName || "VPN KEY" %></div>
            <div class="brand-sub">Fast â€¢ Simple â€¢ Secure</div>
          </div>
        </div>

        <div class="header-actions">
          <% if (panelConfig && panelConfig.telegramChannelUrl) { %>
            <a class="btn btn-ghost" href="<%= panelConfig.telegramChannelUrl %>" target="_blank" rel="noopener">
              âœˆï¸ <span><%= panelConfig.telegramChannelText || "Channel" %></span>
            </a>
          <% } %>
        </div>
      </div>
    </header>

    <main class="container main">
      <section class="card hero">
        <div class="hero-kicker">VPN Key Portal</div>
        <h1 class="hero-title">Key á€€á€­á€¯ á€›á€½á€±á€¸ â†’ Copy â†’ Paste â†’ Connect</h1>
        <p class="hero-desc">
          á€’á€® Website á€™á€¾á€¬ All SIM / WIFI á€¡á€á€½á€€á€º VPN Key á€á€½á€±á€€á€­á€¯ á€œá€½á€šá€ºá€œá€½á€šá€ºá€€á€°á€€á€° á€›á€šá€°á€”á€­á€¯á€„á€ºá€•á€«á€á€šá€ºá‹
          Key á€€á€­á€¯ Copy â†’ á€á€„á€·á€ºá€á€¯á€¶á€¸á€™á€šá€·á€º App á€‘á€² Paste â†’ Connect á€œá€¯á€•á€ºá€•á€¼á€®á€¸á€á€¯á€¶á€¸á€”á€­á€¯á€„á€ºá€•á€«á€á€šá€ºá‹
        </p>

        <div class="hero-actions">
          <% if (panelConfig && panelConfig.telegramAdminUrl) { %>
            <a class="btn btn-soft" href="<%= panelConfig.telegramAdminUrl %>" target="_blank" rel="noopener">
              ğŸ’¬ <span><%= panelConfig.telegramAdminText || "Contact Admin" %></span>
            </a>
          <% } %>
        </div>

        <div class="steps">
          <div>1) Key á€›á€½á€±á€¸</div>
          <div>2) Copy</div>
          <div>3) App á€‘á€² Paste</div>
          <div>4) Connect</div>
        </div>
      </section>

      <section class="card filters">
        <form method="GET" action="/" class="filter-row">
          <input
            class="input"
            type="search"
            name="q"
            value="<%= (query && query.q) ? query.q : "" %>"
            placeholder="Search location... (e.g. Singapore, Japan)"
          />

          <select class="select" name="type">
            <option value="">All Types</option>
            <% (types || []).forEach(function(t){ %>
              <option value="<%= t %>" <%= (query && query.type===t) ? "selected" : "" %>><%= t %></option>
            <% }) %>
          </select>

          <select class="select" name="status">
            <option value="">All Status</option>
            <% (statuses || []).forEach(function(s){ %>
              <option value="<%= s %>" <%= (query && query.status===s) ? "selected" : "" %>><%= s %></option>
            <% }) %>
          </select>

          <button class="btn" type="submit">ğŸ” Filter</button>
        </form>
      </section>

      <section class="list">
        <% if (!items || items.length === 0) { %>
          <div class="card empty">
            <div class="empty-title">No keys found</div>
            <div class="empty-sub">Filter á€€á€­á€¯á€•á€¼á€±á€¬á€„á€ºá€¸á€•á€¼á€®á€¸ á€•á€¼á€”á€ºá€›á€¾á€¬á€€á€¼á€Šá€·á€ºá€•á€«á‹</div>
          </div>
        <% } %>

        <% (items || []).forEach(function(it){ %>
          <a class="card key-card" href="<%= it.link %>">
            <div class="key-top">
              <div class="key-type"><%= it.type %></div>
              <span class="pill <%= (it.statusComputed || '').toUpperCase() %>">
                <%= (it.statusComputed || '').toUpperCase() %>
              </span>
            </div>

            <div class="key-region">
              <span class="flag"><%= it.region_flag || "ğŸŒ" %></span>
              <span class="region"><%= it.region_name %></span>
            </div>

            <div class="key-meta">
              <span>GB <b><%= it.gb_limit || 0 %></b></span>
              <span class="dot">â€¢</span>
              <span>Expire <b><%= it.expire_date || "-" %></b></span>
            </div>

            <div class="key-open">Tap to open â†’</div>
          </a>
        <% }) %>
      </section>

      <section class="card footer-note">
        <div class="note-title">á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€”á€Šá€ºá€¸ (á€¡á€á€­á€¯á€á€»á€¯á€•á€º)</div>
        <ol class="note-list">
          <li>Key á€€á€­á€¯ Copy á€œá€¯á€•á€ºá€•á€«</li>
          <li>á€á€„á€·á€ºá€á€¯á€¶á€¸á€™á€šá€·á€º App á€‘á€² Import / Add â†’ Paste</li>
          <li>Connect á€œá€¯á€•á€ºá€•á€¼á€®á€¸ á€á€¯á€¶á€¸á€•á€«</li>
        </ol>

        <div class="footer-actions">
          <a class="btn btn-soft" href="<%= panelConfig.telegramAdminUrl || '#' %>" target="_blank" rel="noopener">ğŸ§‘â€ğŸ’» Help / Buy Key</a>
          <button class="btn btn-ghost" type="button" id="btnUpdates">ğŸ“£ Updates</button>
        </div>
      </section>

      <p class="copyright">Â© <%= new Date().getFullYear() %> <%= panelConfig.brandName || "VPN KEY" %></p>
    </main>
  </div>

  <% if (panelConfig && panelConfig.announceHtml && panelConfig.announceVersion) { %>
    <div class="modal" id="announceModal" hidden>
      <div class="modal-backdrop"></div>
      <div class="modal-card" role="dialog" aria-modal="true">
        <div class="modal-head">
          <div class="modal-title">ğŸ“£ Announcement</div>
          <button class="btn btn-ghost" id="announceClose" type="button">âœ–</button>
        </div>
        <div class="modal-body">
          <%- panelConfig.announceHtml %>
        </div>
        <div class="modal-foot">
          <button class="btn" id="announceOk" type="button">OK</button>
        </div>
      </div>
    </div>

    <script>
      (function(){
        const ver = "<%= panelConfig.announceVersion %>";
        const key = "announce_seen_" + ver;
        const modal = document.getElementById("announceModal");
        const close = () => { modal.hidden = true; localStorage.setItem(key, "1"); };
        if (!localStorage.getItem(key)) modal.hidden = false;
        document.getElementById("announceClose").addEventListener("click", close);
        document.getElementById("announceOk").addEventListener("click", close);
        modal.querySelector(".modal-backdrop").addEventListener("click", close);
      })();
    </script>
  <% } %>

  <script>
    document.getElementById("btnUpdates")?.addEventListener("click", function(){
      const url = "<%= (panelConfig && panelConfig.telegramChannelUrl) ? panelConfig.telegramChannelUrl : "#" %>";
      if (url && url !== "#") window.open(url, "_blank");
    });
  </script>
</body>
</html>
